# SETC ç³»çµ±æ¶æ§‹è¨­è¨ˆæ–‡æª”

> æ–‡ä»¶ç‰ˆæœ¬: 3.23.0  
> æ›´æ–°æ—¥æœŸ: 2025-12-16  
> æ–‡ä»¶æ€§è³ª: ç³»çµ±æµç¨‹èˆ‡æ¨¡çµ„å”ä½œå®šç¾©

---

## ç›®éŒ„

1. [æ•´é«”è¨­è¨ˆåŸå‰‡](#ä¸€æ•´é«”è¨­è¨ˆåŸå‰‡)
2. [æ¨¡çµ„å®šç¾©èˆ‡è¦ç¯„](#äºŒæ¨¡çµ„å®šç¾©èˆ‡è¦ç¯„)
3. [Blueprint Layer è¨­è¨ˆ](#ä¸‰blueprint-layer-è¨­è¨ˆ)
4. [å·¥ä½œæµç¨‹å®šç¾©](#å››å·¥ä½œæµç¨‹å®šç¾©)
5. [æ¨¡çµ„æ¨™æº–éª¨æ¶](#äº”æ¨¡çµ„æ¨™æº–éª¨æ¶)

---

## ä¸€ã€æ•´é«”è¨­è¨ˆåŸå‰‡

### æ ¸å¿ƒç†å¿µ

**æœ€é‡è¦çš„ä¸€æ¢éµå¾‹ï¼š**
> Blueprint Layer æ°¸é ä¸æ‡‰è©²çŸ¥é“ã€Œè³‡æ–™é•·ä»€éº¼æ¨£å­ã€ï¼ŒåªçŸ¥é“ã€Œäº‹ä»¶ã€è¦å‰‡èˆ‡æµç¨‹ã€ã€‚

**æ¨¡çµ„èˆ‡ Blueprint çš„åˆ†å·¥ï¼š**
> æ¨¡çµ„è² è²¬ã€ŒæŠŠä¸€ä»¶äº‹åšå¥½ã€ï¼ŒBlueprint è² è²¬ã€ŒæŠŠäº‹æƒ…ä¸²èµ·ä¾†ã€ã€‚

### ç³»çµ±ç‰¹æ€§

- ç³»çµ±æ¡ **äº‹ä»¶é©…å‹•ï¼ˆEvent-Drivenï¼‰æµç¨‹**
- æ¨¡çµ„å½¼æ­¤è§£è€¦ï¼Œé€éäº‹ä»¶èˆ‡ Facade æºé€š
- æ‰€æœ‰ç‹€æ…‹è®Šæ›´çš†å¯è¢«ç¨½æ ¸ï¼ˆAudit Logï¼‰
- æ ¸å¿ƒå¯¦é«”ï¼ˆContract / Task / Issue / Acceptance / Financeï¼‰çš†å…·å‚™ç¨ç«‹ç”Ÿå‘½é€±æœŸ
- è‡ªå‹•ç¯€é»ä¸åŒ…å« UI è¡Œç‚ºï¼Œåƒ…è² è²¬ç‹€æ…‹æ¨é€²èˆ‡è³‡æ–™ç”¢ç”Ÿ

### æ¨¡çµ„äº’å‹•åŸå‰‡

**æ¯å€‹æ¨¡çµ„åªåšå…©ä»¶äº‹ï¼š**
1. ç™¼äº‹ä»¶ï¼ˆæˆ‘å®Œæˆäº†ä»€éº¼ï¼‰
2. è¨‚é–±äº‹ä»¶ï¼ˆæˆ‘å°å“ªäº›äº‹æœ‰åæ‡‰ï¼‰

---

## äºŒã€æ¨¡çµ„å®šç¾©èˆ‡è¦ç¯„

### 2.1 æ¨¡çµ„çš„å®šç¾©

**ä¸€å¥è©±å®šç¾©ï¼š**
> æ¨¡çµ„æ˜¯ã€Œæ“æœ‰æ˜ç¢ºæ¥­å‹™èªæ„èˆ‡å®Œæ•´ç”Ÿå‘½é€±æœŸçš„ Domain é‚Šç•Œã€

**æ¨¡çµ„å¿…é ˆå…·å‚™çš„æ¢ä»¶ï¼ˆç¼ºä¸€ä¸å¯ï¼‰ï¼š**

| æ¢ä»¶ | èªªæ˜ |
|------|------|
| æ¥­å‹™èªæ„ | èƒ½å›ç­”ã€Œæˆ‘åœ¨ç®¡ä»€éº¼ã€ |
| æ ¸å¿ƒå¯¦é«” | è‡³å°‘ä¸€å€‹ Aggregate Root |
| ç”Ÿå‘½é€±æœŸ | æ˜ç¢ºç‹€æ…‹æµè½‰ |
| é‚Šç•Œ | ä¸è¢«å…¶ä»–æ¨¡çµ„ç›´æ¥æ“ä½œè³‡æ–™ |
| å°å¤–ä»‹é¢ | åªèƒ½é€é Facade / Events |

### 2.2 æ¨¡çµ„çš„è²¬ä»»ç¯„åœ

**æ¨¡çµ„ã€Œå¯ä»¥ã€è² è²¬ï¼š**
- Domain Entity / Value Object
- ç‹€æ…‹è½‰æ›ï¼ˆState Machineï¼‰
- Domain Service
- Domain Eventï¼ˆç™¼ä½ˆï¼‰
- Repository Interface
- Facadeï¼ˆå°å¤– APIï¼‰

**æ¨¡çµ„ã€Œä¸èƒ½ã€è² è²¬ï¼š**
- âŒ è·¨æ¨¡çµ„æµç¨‹å”èª¿
- âŒ å…¨ç³»çµ±è¦å‰‡ï¼ˆPolicyï¼‰
- âŒ Queue / Retry / Orchestration
- âŒ UI æ¬Šé™æ±ºç­–ï¼ˆåªèƒ½å›å‚³çµæœï¼‰
- âŒ å…¶ä»–æ¨¡çµ„çš„è³‡æ–™ä¿®æ”¹

### 2.3 æ¨™æº–æ¨¡çµ„ç›®éŒ„çµæ§‹ï¼ˆå¼·åˆ¶ï¼‰

```
/modules/<module-name>/
â”œâ”€ models/              # Entity / Value Object
â”œâ”€ states/              # ç‹€æ…‹å®šç¾©èˆ‡è½‰ç§»
â”œâ”€ services/            # Domain Services
â”œâ”€ repositories/        # Repository Interface + Impl
â”œâ”€ events/              # Domain Event å®šç¾©
â”œâ”€ policies/            # æ¨¡çµ„å…§è¦å‰‡ï¼ˆéç³»çµ±ç´šï¼‰
â”œâ”€ facade/              # å°å¤–æ“ä½œå…¥å£ï¼ˆå”¯ä¸€ï¼‰
â”œâ”€ config/              # æ¨¡çµ„è¨­å®š
â”œâ”€ module.metadata.ts   # æ¨¡çµ„æè¿°ï¼ˆåç¨±ã€äº‹ä»¶ã€èƒ½åŠ›ï¼‰
â”œâ”€ <module>.module.ts   # DI / Module å®šç¾©
â””â”€ README.md            # æ¨¡çµ„èªªæ˜
```

> â— ä»»ä½•è·¨æ¨¡çµ„å‘¼å«ï¼Œåªèƒ½é€é `facade/`

### 2.4 å„è³‡æ–™å¤¾è²¬ä»»èªªæ˜

#### `/models`

**ç”¨é€”ï¼š**
- å®šç¾© Domain Entity
- å®šç¾© Value Object
- å®šç¾© Aggregate Root

**ç¦æ­¢äº‹é …ï¼š**
- âŒ ä¸åŒ…å« CRUD
- âŒ ä¸åŒ…å« API / UI é‚è¼¯
- âŒ ä¸å­˜å– Repository

#### `/states`

**ç”¨é€”ï¼š**
- ç‹€æ…‹ enum
- ç‹€æ…‹è½‰ç§»è¡¨
- State Machine

```typescript
TaskState: CREATED â†’ IN_PROGRESS â†’ COMPLETED
```

**ç¦æ­¢äº‹é …ï¼š**
- âŒ ä¸ç›´æ¥æ”¹è³‡æ–™
- âŒ ä¸å‘¼å«å…¶ä»–æ¨¡çµ„

#### `/services`

**ç”¨é€”ï¼š**
- å¯¦ä½œæ¥­å‹™è¡Œç‚º
- åŸ·è¡Œç‹€æ…‹è½‰æ›
- ç™¼ä½ˆ Domain Event

**å…è¨±ï¼š**
- å‘¼å«æœ¬æ¨¡çµ„ Repository
- å‘¼å« Blueprint EventBus
- ä½¿ç”¨æœ¬æ¨¡çµ„ Policy

#### `/repositories`

**ç”¨é€”ï¼š**
- è³‡æ–™å­˜å–æŠ½è±¡
- Infrastructure èˆ‡ Domain çš„éš”é›¢å±¤

**è¦ç¯„ï¼š**
- Interface + Implementation åˆ†é›¢
- Domain ä¸çŸ¥é“è³‡æ–™ä¾†æº

#### `/events`

**ç”¨é€”ï¼š**
- å®šç¾©æ¨¡çµ„å¯ç™¼ä½ˆçš„ Domain Event
- å®šç¾© Event Payload Schema

**è¦ç¯„ï¼š**
- äº‹ä»¶å‘½åå¿…é ˆä»¥æ¨¡çµ„ç‚ºå‰ç¶´

```typescript
task.created
task.completed
```

#### `/policies`ï¼ˆæ¨¡çµ„å…§ï¼‰

**ç”¨é€”ï¼š**
- åƒ…é™æœ¬æ¨¡çµ„çš„æ¥­å‹™è¦å‰‡
- ä¸è·¨æ¨¡çµ„

**ç¯„ä¾‹ï¼š**
- ä»»å‹™å®Œæˆæ¢ä»¶
- ç‹€æ…‹åˆæ³•æ€§æª¢æŸ¥

#### `/facade`

> âš ï¸ **æœ€é‡è¦çš„ä¸€å±¤** - Facade æ˜¯æ¨¡çµ„å°å¤–çš„å”¯ä¸€å…¥å£

**è²¬ä»»ï¼š**
- æ¥æ”¶å¤–éƒ¨è«‹æ±‚
- é©—è­‰ Policy
- å‘¼å« Domain Service
- å›å‚³çµæœ
- ç™¼ä½ˆäº‹ä»¶ï¼ˆæˆ–ç”± Service ç™¼ï¼‰

**ç¦æ­¢ï¼š**
- âŒ ä¸ç›´æ¥æ“ä½œ DB
- âŒ ä¸å¯«è·¨æ¨¡çµ„æµç¨‹
- âŒ ä¸å¯« UI é‚è¼¯

#### `/module.metadata.ts`

**ç”¨é€”ï¼š**
- æè¿°æ¨¡çµ„èƒ½åŠ›
- å®£å‘Šäº‹ä»¶æ¸…å–®
- å®£å‘Šå°å¤– API

**ç¯„ä¾‹ï¼š**
```typescript
export const TaskModuleMetadata = {
  name: 'task',
  events: ['task.created', 'task.completed'],
  capabilities: ['assign', 'complete', 'schedule']
};
```

### 2.5 æ¨¡çµ„èˆ‡æ¨¡çµ„ä¹‹é–“çš„äº’å‹•è¦å‰‡ï¼ˆéµå¾‹ï¼‰

**åªå…è¨±ä¸‰ç¨®äº’å‹•æ–¹å¼ï¼š**

| æ–¹å¼ | èªªæ˜ |
|------|------|
| Event | éåŒæ­¥åæ‡‰ |
| Facade | æ˜ç¢ºæŒ‡ä»¤ |
| Query | Read-only |

**âŒ ç¦æ­¢è¡Œç‚ºï¼š**
- ç›´æ¥å­˜å–åˆ¥çš„ Repository
- ç›´æ¥ new åˆ¥çš„ Service
- æ”¹å¯«åˆ¥çš„æ¨¡çµ„ç‹€æ…‹

### 2.6 æ¨¡çµ„äº‹ä»¶è¦ç¯„ï¼ˆå¼·åˆ¶ï¼‰

**äº‹ä»¶å¿…é ˆæ˜¯ã€Œäº‹å¯¦ã€ï¼š**
- âœ… `task.completed`
- âŒ `completeTask`

**Payload åŸå‰‡ï¼š**
- ä¸åŒ…å« Domain Entity
- åªåŒ…å«è­˜åˆ¥è³‡è¨Š

### 2.7 æ¨¡çµ„æˆç†Ÿåº¦æª¢æŸ¥è¡¨

- [ ] æ˜¯å¦åªæœ‰ Facade å°å¤–ï¼Ÿ
- [ ] æ˜¯å¦æ²’æœ‰ç›´æ¥ä¾è³´å…¶ä»–æ¨¡çµ„ï¼Ÿ
- [ ] æ˜¯å¦æ‰€æœ‰ç‹€æ…‹è½‰ç§»é›†ä¸­ç®¡ç†ï¼Ÿ
- [ ] æ˜¯å¦æ‰€æœ‰è·¨æ¨¡çµ„è¡Œç‚ºéƒ½æ˜¯äº‹ä»¶ï¼Ÿ
- [ ] æ˜¯å¦ç„¡ Blueprint åå‘ä¾è³´ï¼Ÿ

---

## ä¸‰ã€Blueprint Layer è¨­è¨ˆ

> Blueprint Layer æä¾›è·¨æ¨¡çµ„çš„æµç¨‹èƒ½åŠ›èˆ‡ç³»çµ±è¦å‰‡ï¼Œä¸æ‰¿è¼‰ä»»ä½•æ¥­å‹™èªæ„ã€ä¸æ“æœ‰ Domain ç‹€æ…‹ã€ä¸å–ä»£æ¨¡çµ„æ±ºç­–ã€‚

### 3.1 Blueprint å±¤ç¸½çµå°ç…§è¡¨

| è³‡æ–™å¤¾ | å›ç­”çš„å•é¡Œ | æœ‰ç‹€æ…‹ | æœ‰æ¥­å‹™èªæ„ |
|--------|-----------|--------|-----------|
| event-bus | ç™¼ç”Ÿäº†ä»€éº¼ | âŒ | âŒ |
| workflow | ä¸‹ä¸€æ­¥æ˜¯ä»€éº¼ | âš ï¸ï¼ˆæµç¨‹ç‹€æ…‹ï¼‰ | âŒ |
| audit | ç™¼ç”Ÿéä»€éº¼ | âœ…ï¼ˆæ­·å²ï¼‰ | âŒ |
| policies | å¯ä¸å¯ä»¥ | âŒ | âš ï¸ï¼ˆè¦å‰‡ï¼‰ |

### 3.2 `/blueprint/event-bus`

**ä¸€å¥è©±å®šä½ï¼š**
> ç³»çµ±äº‹ä»¶çš„å‚³éèˆ‡åˆ†ç™¼ä¸­æ¨ï¼ˆä¸åŒ…å«æ¥­å‹™é‚è¼¯ï¼‰

**æ ¸å¿ƒè·è²¬ï¼š**

æä¾›äº‹ä»¶çš„ï¼š
- ç™¼ä½ˆï¼ˆemit / publishï¼‰
- è¨‚é–±ï¼ˆsubscribeï¼‰
- åˆ†æ´¾ï¼ˆdispatchï¼‰

ç¢ºä¿äº‹ä»¶ï¼š
- çµæ§‹ä¸€è‡´
- å¯è¿½è¹¤ï¼ˆCorrelation IDï¼‰
- å¯é‡è©¦ï¼ˆRetry / DLQï¼‰

**âŒ çµ•å°ä¸èƒ½åšçš„äº‹æƒ…ï¼š**
- âŒ åˆ¤æ–·ã€Œé€™å€‹äº‹ä»¶è©²ä¸è©²ç™¼ç”Ÿã€
- âŒ æ”¹å¯«äº‹ä»¶ payload
- âŒ æ ¹æ“šäº‹ä»¶å…§å®¹åŸ·è¡Œæ¥­å‹™é‚è¼¯
- âŒ ä¾è³´ä»»ä½• Domain Module

**æ ¸å¿ƒç†å¿µï¼š**
> Event Bus æ˜¯ä¸€å€‹è·¨æ¨¡çµ„çš„æµç¨‹åŸºç¤è¨­æ–½ï¼ˆProcess Infrastructureï¼‰ï¼Œè² è²¬å‚³éã€Œå·²ç™¼ç”Ÿäº‹å¯¦ã€ï¼Œä¸æ‰¿è¼‰æ¥­å‹™æ±ºç­–ã€‚

### 3.3 `/blueprint/workflow`

**ä¸€å¥è©±å®šä½ï¼š**
> è·¨æ¨¡çµ„æµç¨‹çš„ã€Œå”èª¿è€…ã€ï¼Œç”¨æ–¼é«˜é¢¨éšªæˆ–å¤šæ­¥é©Ÿæµç¨‹

**ä»€éº¼æ™‚å€™ã€Œéœ€è¦ã€ Workflowï¼š**

åªæœ‰åœ¨ä»¥ä¸‹æƒ…æ³æ‰ä½¿ç”¨ï¼š
- æ¶‰åŠå¤šå€‹æ¨¡çµ„
- ä¸­é–“æ­¥é©Ÿå¯èƒ½å¤±æ•—
- éœ€è¦è£œå„Ÿï¼ˆRollback / Sagaï¼‰
- æµç¨‹ã€Œä¸èƒ½åªé äº‹ä»¶è‡ªç„¶æ“´æ•£ã€

**ä¾‹å¦‚ï¼š**
- è«‹æ¬¾ â†’ é–‹ç¥¨ â†’ æ”¶æ¬¾ â†’ å…¥å¸³
- è§£ç´„ â†’ å›æ»¾ä»»å‹™ â†’ å›æ»¾è²¡å‹™ â†’ é€šçŸ¥

**å¯ä»¥åšçš„äº‹æƒ…ï¼š**
- è¨‚é–±å¤šå€‹äº‹ä»¶
- ç®¡ç†æµç¨‹ç‹€æ…‹ï¼ˆProcess Stateï¼‰
- ç™¼å‡ºä¸‹ä¸€æ­¥æŒ‡ä»¤å‹äº‹ä»¶
- è§¸ç™¼è£œå„Ÿäº‹ä»¶

**âŒ ä¸èƒ½åšçš„äº‹æƒ…ï¼š**
- âŒ ä¸å¾—å­˜å– Domain Repository
- âŒ ä¸å¾—æ”¹å¯« Domain ç‹€æ…‹
- âŒ ä¸å¾—å¯« UI æˆ–æ¬Šé™é‚è¼¯
- âŒ ä¸å¾—è®Šæˆæµç¨‹ä¸Šå¸

**æ­£ç¢ºå¿ƒæ³•ï¼š**
> Workflow ä¸ã€Œåšäº‹ã€ï¼Œåªã€Œæ±ºå®šæ¥ä¸‹ä¾†è¦å«èª°åšäº‹ã€ã€‚

### 3.4 `/blueprint/audit`

**ä¸€å¥è©±å®šä½ï¼š**
> ç³»çµ±è¡Œç‚ºçš„ä¸å¯è®Šæ­·å²ç´€éŒ„å±¤

**æ ¸å¿ƒè·è²¬ï¼š**

è¨˜éŒ„æ‰€æœ‰ï¼š
- æ‰‹å‹•æ“ä½œ
- é‡è¦ç‹€æ…‹è®Šæ›´
- é—œéµäº‹ä»¶

æä¾›ï¼š
- äº‹å¾Œè¿½è¹¤
- ç¨½æ ¸æŸ¥è©¢
- å•è²¬ä¾æ“š

**å¯ä»¥è¨˜éŒ„çš„å…§å®¹ï¼š**
- æ“ä½œäºº
- æ“ä½œæ™‚é–“
- æ¨¡çµ„ä¾†æº
- è¡Œç‚ºé¡å‹
- ç‹€æ…‹å‰ / å¾Œ
- Correlation ID

**âŒ ä¸èƒ½åšçš„äº‹æƒ…ï¼š**
- âŒ ä¸å½±éŸ¿æµç¨‹
- âŒ ä¸é˜»æ–·æ“ä½œ
- âŒ ä¸ç•¶æˆæ¥­å‹™è³‡æ–™ä¾†æº
- âŒ ä¸å›å¯« Domain

**å¸¸è¦‹èª¤ç”¨ï¼š**
> âŒ ç”¨ Audit Log ç•¶ä½œã€Œæµç¨‹åˆ¤æ–·ä¾æ“šã€  
> ğŸ‘‰ Audit æ˜¯æ­·å²ï¼Œä¸æ˜¯çœŸç›¸ä¾†æº

### 3.5 `/blueprint/policies`

**ä¸€å¥è©±å®šä½ï¼š**
> è·¨æ¨¡çµ„çš„ä¸€è‡´æ€§è¦å‰‡èˆ‡é™åˆ¶æ¢ä»¶

**é©åˆæ”¾åœ¨ Policy çš„æ±è¥¿ï¼š**
- ç‹€æ…‹è½‰æ›è¦å‰‡
- æ“ä½œå‰ç½®æ¢ä»¶
- è§’è‰² / æ¬Šé™çŸ©é™£ï¼ˆé‚è¼¯å±¤ï¼‰
- ç³»çµ±ç´š Guard

**ä¾‹å¦‚ï¼š**
- æœªç”Ÿæ•ˆåˆç´„ä¸å¯å»ºç«‹ä»»å‹™
- é©—æ”¶æœªé€šéä¸å¯è«‹æ¬¾
- å·²çµæ¡ˆå•é¡Œä¸å¯å†ç·¨è¼¯

**å¯ä»¥åšçš„äº‹æƒ…ï¼š**
- æä¾›ç´”é‚è¼¯åˆ¤æ–·
- è¤‡ç”¨é©—è­‰ç¢¼

```typescript
canCreateTask(contract): boolean
```

- è¢«å¤šå€‹æ¨¡çµ„å…±ç”¨
- ä¸ä¾è³´ UI / DB

**âŒ ä¸èƒ½åšçš„äº‹æƒ…ï¼š**
- âŒ ä¸å­˜è³‡æ–™
- âŒ ä¸ç™¼äº‹ä»¶
- âŒ ä¸åŸ·è¡Œæµç¨‹
- âŒ ä¸è™•ç†ä¾‹å¤–æµç¨‹

**å¿ƒæ³•ä¸€å¥è©±ï¼š**
> Policy å›ç­”çš„æ˜¯ï¼šã€Œå¯ä¸å¯ä»¥ã€ï¼Œä¸æ˜¯ï¼šã€Œæ€éº¼åšã€

---

## å››ã€å·¥ä½œæµç¨‹å®šç¾©

### 4.1 åˆç´„å»ºç«‹èˆ‡ä¾†æºæµç¨‹

```
åˆç´„ä¸Šå‚³ï¼ˆPDF / åœ–æª”ï¼‰ã€æ‰‹å‹•ã€‘
â†“
åˆç´„å»ºæª”ï¼ˆåŸºæœ¬è³‡æ–™ã€æ¥­ä¸»ã€æ‰¿å•†ï¼‰ã€æ‰‹å‹•ã€‘
â†“
åˆç´„è§£æï¼ˆOCR / AI è§£ææ¢æ¬¾ã€é‡‘é¡ã€å·¥é …ï¼‰ã€è‡ªå‹•ã€‘
â†“
åˆç´„ç¢ºèªï¼ˆç¢ºèªè§£æçµæœæˆ–äººå·¥è£œé½Šï¼‰ã€æ‰‹å‹•ã€‘
â†“
åˆç´„ç‹€æ…‹ï¼šå¾…ç”Ÿæ•ˆ
â†“
åˆç´„ç”Ÿæ•ˆï¼ˆåƒ…å·²ç”Ÿæ•ˆåˆç´„å¯å»ºç«‹ä»»å‹™ï¼‰ã€æ‰‹å‹•ã€‘
```

### 4.2 ä»»å‹™èˆ‡æ–½å·¥éšæ®µ

```
ä»»å‹™å»ºç«‹ï¼ˆé—œè¯åˆç´„ / å·¥é … / é‡‘é¡ï¼‰ã€æ‰‹å‹•ã€‘
â†“
æŒ‡æ´¾ä½¿ç”¨è€…æˆ–åœ˜éšŠã€æ‰‹å‹•ã€‘
â†“
æ–½å·¥åŸ·è¡Œ
â†“
æå ±å®Œæˆã€æ‰‹å‹•ã€‘
â†“
ç®¡ç†ç¢ºèªå®Œæˆã€æ‰‹å‹•ã€‘
```

> æ­¤ç¯€é»åƒ…ç¢ºèªæ–½å·¥è²¬ä»»å®Œæˆï¼Œä¸ç­‰åŒæ–¼é©—æ”¶å®Œæˆ

### 4.3 å“è³ªèˆ‡é©—æ”¶éšæ®µ

```
è‡ªå‹•å»ºç«‹æ–½å·¥æ—¥èªŒã€è‡ªå‹•ã€‘
â†“
è‡ªå‹•å»ºç«‹ QC å¾…é©—ã€è‡ªå‹•ã€‘
â†“
QC é€šéï¼Ÿ
```

**QC åˆ¤å®šæµç¨‹ï¼š**

- **å¦**
  ```
  å»ºç«‹ç¼ºå¤±å–®ã€è‡ªå‹•ã€‘
  â†“
  æ•´æ”¹ã€æ‰‹å‹•ã€‘
  â†“
  è¤‡é©—ã€æ‰‹å‹•ã€‘
  â†“
  å›åˆ° QC åˆ¤å®š
  ```

- **æ˜¯**
  ```
  â†“
  é©—æ”¶ã€æ‰‹å‹•ã€‘
  ```

**é©—æ”¶åˆ¤å®šæµç¨‹ï¼š**

é©—æ”¶é€šéï¼Ÿ

- **å¦**
  ```
  å»ºç«‹å•é¡Œå–®ã€å¯æ‰‹å‹• / å¯è‡ªå‹•ã€‘
  â†“
  å•é¡Œè™•ç†ã€æ‰‹å‹•ã€‘
  â†“
  å›åˆ°é©—æ”¶
  ```

- **æ˜¯**
  ```
  â†“
  é©—æ”¶è³‡æ–™å°å­˜ã€è‡ªå‹•ã€‘
  â†“
  é€²å…¥ä¿å›ºæœŸã€è‡ªå‹•ã€‘
  ```

### 4.4 ä¿å›ºæœŸç®¡ç†æµç¨‹

**ä¿å›ºæœŸé–“ï¼š**

ç™¼ç”Ÿä¿å›ºç¼ºå¤±ï¼Ÿ

- **æ˜¯**
  ```
  å»ºç«‹å•é¡Œå–®ã€å¯æ‰‹å‹• / å¯è‡ªå‹•ã€‘
  â†“
  ä¿å›ºç¶­ä¿®ã€æ‰‹å‹•ã€‘
  â†“
  çµæ¡ˆã€æ‰‹å‹•ã€‘
  ```

- **å¦**
  ```
  æŒçºŒä¿å›ºç›£æ§
  ```

**ä¿å›ºæœŸæ»¿ï¼š**
```
ä¿å›ºæœŸæ»¿ã€è‡ªå‹•ã€‘
â†“
æœ€çµ‚é©—æ”¶çµæ¡ˆã€æ‰‹å‹•ã€‘
```

### 4.5 è²¡å‹™èˆ‡æˆæœ¬éšæ®µ

```
é‡‘é¡ / æ¯”ä¾‹ç¢ºèªï¼ˆå¯è«‹æ¬¾æ¯”ä¾‹ / å¯ä»˜æ¬¾æ¯”ä¾‹ï¼‰ã€æ‰‹å‹•ã€‘
â†“
å»ºç«‹å¯è«‹æ¬¾æ¸…å–® + å¯ä»˜æ¬¾æ¸…å–®ã€è‡ªå‹•ã€‘
ï¼ˆæ¥­ä¸» / æ‰¿å•†åˆ†é›¢ï¼‰
â†“
è«‹æ¬¾ / ä»˜æ¬¾æµç¨‹ã€æ‰‹å‹•ã€‘
```

**æµç¨‹ç‹€æ…‹ï¼š**
- è‰ç¨¿
- é€å‡º
- å¯©æ ¸
- é–‹ç¥¨
- æ”¶æ¬¾ / ä»˜æ¬¾

**è²¡å‹™å¯©æ ¸æµç¨‹ï¼š**

å¯©æ ¸çµæœï¼š
- é€šé â†’ ç¹¼çºŒæµç¨‹
- é€€å› â†’ è£œä»¶ â†’ ä¿®æ­£ â†’ å†æ¬¡å¯©æ ¸

**è²¡å‹™ç‹€æ…‹åŒæ­¥ï¼š**

```
æ›´æ–°ä»»å‹™æ¬¾é …ç‹€æ…‹ã€è‡ªå‹•ã€‘
```

- è«‹æ¬¾é€²åº¦ç™¾åˆ†æ¯”
- ä»˜æ¬¾é€²åº¦ç™¾åˆ†æ¯”

**æˆæœ¬èˆ‡åˆ†æï¼š**

è‡ªå‹•è¨ˆå…¥æˆæœ¬ç®¡ç†ï¼š
- å¯¦éš›æˆæœ¬
- æ‡‰æ”¶é‡‘é¡
- æ‡‰ä»˜é‡‘é¡
- æ¯›åˆ©èˆ‡æˆæœ¬åˆ†æ

### 4.6 å•é¡Œå–®ï¼ˆIssueï¼‰è¨­è¨ˆåŸå‰‡

- å•é¡Œå–®ç‚º **ç¨ç«‹æ¨¡çµ„**
- ä¸å°ˆå±¬æ–¼é©—æ”¶æµç¨‹
- å¯ç”±å¤šä¾†æºå»ºç«‹
- å…·å‚™å®Œæ•´ç”Ÿå‘½é€±æœŸ

**å•é¡Œå–®ç”Ÿå‘½é€±æœŸï¼š**
```
open â†’ in_progress â†’ resolved â†’ verified â†’ closed
```

**å•é¡Œå–®å»ºç«‹ä¾†æºï¼ˆæ¦‚å¿µï¼‰ï¼š**
- é©—æ”¶å¤±æ•—
- QC æª¢é©—å¤±æ•—
- ä¿å›ºç¼ºå¤±
- å®‰å…¨äº‹ä»¶
- ä½¿ç”¨è€…æ‰‹å‹•å»ºç«‹

### 4.7 äº‹ä»¶èˆ‡è‡ªå‹•åŒ–åŸå‰‡

- æ‰€æœ‰è‡ªå‹•æµç¨‹çš†ç”± **äº‹ä»¶æˆ– Queue è§¸ç™¼**
- ç‹€æ…‹æ”¹è®Šå³ç”¢ç”Ÿäº‹ä»¶
- äº‹ä»¶ä¸åŒ…å« UI æˆ–ä½¿ç”¨è€…äº’å‹•é‚è¼¯

### 4.8 ç¨½æ ¸èˆ‡æ¬Šé™æ§åˆ¶

**Audit Logï¼ˆå¿…è¦ï¼‰ï¼š**

æ‰€æœ‰ã€æ‰‹å‹•ã€‘ç¯€é»éœ€è¨˜éŒ„ï¼š
- æ“ä½œäºº
- æ“ä½œæ™‚é–“
- ç‹€æ…‹è®Šæ›´å‰å¾Œ
- å‚™è¨»æˆ–åŸå› 

**æ¬Šé™è¨­è¨ˆï¼š**
- ä¸åŒè§’è‰²å¯æ“ä½œä¸åŒç¯€é»
- æ¬Šé™ä¸ç¡¬ç·¨ç¢¼æ–¼ UI
- ç”±æ¨¡çµ„å±¤æˆ–æ”¿ç­–å±¤æ§ç®¡

---

## äº”ã€æ¨¡çµ„æ¨™æº–éª¨æ¶

### 5.1 æ¨¡çµ„è³‡æ–™å¤¾éª¨æ¶ï¼ˆæ¨™æº–ï¼‰

```
/modules/<module-name>/
â”œâ”€ models/
â”‚  â””â”€ index.ts
â”‚
â”œâ”€ states/
â”‚  â””â”€ <module>.states.ts
â”‚
â”œâ”€ services/
â”‚  â”œâ”€ <module>.service.ts
â”‚  â””â”€ index.ts
â”‚
â”œâ”€ repositories/
â”‚  â”œâ”€ <module>.repository.ts        # Interface
â”‚  â”œâ”€ <module>.repository.impl.ts   # Implementation
â”‚  â””â”€ index.ts
â”‚
â”œâ”€ events/
â”‚  â”œâ”€ <module>.events.ts
â”‚  â””â”€ index.ts
â”‚
â”œâ”€ policies/
â”‚  â”œâ”€ <module>.policies.ts
â”‚  â””â”€ index.ts
â”‚
â”œâ”€ facade/
â”‚  â”œâ”€ <module>.facade.ts
â”‚  â””â”€ index.ts
â”‚
â”œâ”€ config/
â”‚  â””â”€ <module>.config.ts
â”‚
â”œâ”€ module.metadata.ts
â”œâ”€ <module>.module.ts
â””â”€ README.md
```

> `<module-name>` ä¾‹å¦‚ï¼štaskã€issueã€contract

### 5.2 æ¯å€‹æª”æ¡ˆçš„æœ€å°éª¨æ¶å…§å®¹

> ä»¥ä¸‹å…§å®¹ä¸æ˜¯ç¤ºä¾‹ï¼Œæ˜¯æ¨™æº–èµ·æ‰‹å¼ã€‚

#### `/models/index.ts`

```typescript
export * from './<module>.entity';
export * from './<module>.value-object';
```

> â— models åªæ”¾ç´” Domain çµæ§‹

#### `/states/<module>.states.ts`

```typescript
export enum <Module>State {
  CREATED = 'CREATED',
  IN_PROGRESS = 'IN_PROGRESS',
  COMPLETED = 'COMPLETED',
}

export const <Module>StateTransitions = {
  CREATED: ['IN_PROGRESS'],
  IN_PROGRESS: ['COMPLETED'],
  COMPLETED: [],
};
```

> â— æ‰€æœ‰ç‹€æ…‹è½‰ç§»å¿…é ˆé›†ä¸­åœ¨é€™è£¡

#### `/services/<module>.service.ts`

```typescript
export class <Module>Service {
  constructor(
    private readonly repository: <Module>Repository,
  ) {}

  executeAction(params: any) {
    // 1. é©—è­‰ policy
    // 2. ç‹€æ…‹è½‰ç§»
    // 3. å„²å­˜è³‡æ–™
    // 4. ç™¼ä½ˆäº‹ä»¶
  }
}
```

#### `/services/index.ts`

```typescript
export * from './<module>.service';
```

#### `/repositories/<module>.repository.ts`

```typescript
import { <Module> } from '../models';

export interface <Module>Repository {
  findById(id: string): Promise<<Module> | null>;
  save(entity: <Module>): Promise<void>;
}
```

#### `/repositories/<module>.repository.impl.ts`

```typescript
import { <Module>Repository } from './<module>.repository';

export class <Module>RepositoryImpl implements <Module>Repository {
  async findById(id: string) {
    // Infrastructure implementation
    return null;
  }

  async save(entity: any) {
    // Infrastructure implementation
  }
}
```

#### `/events/<module>.events.ts`

```typescript
export const <Module>Events = {
  CREATED: '<module>.created',
  UPDATED: '<module>.updated',
  COMPLETED: '<module>.completed',
} as const;
```

> â— äº‹ä»¶å‘½åä¸€å®šè¦ï¼š`<module>.<fact>`

#### `/events/index.ts`

```typescript
export * from './<module>.events';
```

#### `/policies/<module>.policies.ts`

```typescript
export class <Module>Policies {
  static canExecute(currentState: string): boolean {
    return currentState !== 'COMPLETED';
  }
}
```

> â— Policy åªå›å‚³ boolean æˆ–éŒ¯èª¤åŸå› 

#### `/policies/index.ts`

```typescript
export * from './<module>.policies';
```

#### `/facade/<module>.facade.ts`

```typescript
export class <Module>Facade {
  constructor(
    private readonly service: <Module>Service,
  ) {}

  async executeCommand(command: any) {
    // 1. é©—è­‰è¼¸å…¥
    // 2. å‘¼å« service
    return this.service.executeAction(command);
  }
}
```

> âš ï¸ å¤–éƒ¨åªèƒ½å‘¼å« Facade

#### `/facade/index.ts`

```typescript
export * from './<module>.facade';
```

#### `/config/<module>.config.ts`

```typescript
export const <Module>Config = {
  enableEvents: true,
};
```

#### `/module.metadata.ts`

```typescript
export const <Module>ModuleMetadata = {
  name: '<module>',
  description: '<module> domain module',
  events: [
    '<module>.created',
    '<module>.updated',
  ],
  capabilities: [
    'create',
    'update',
    'complete',
  ],
};
```

#### `/<module>.module.ts`

```typescript
import { Module } from '@angular/core';

@Module({
  providers: [
    // RepositoryImpl
    // Service
    // Facade
  ],
})
export class <Module>Module {}
```

#### `/README.md`

```markdown
# <Module> Module

## Purpose
æœ¬æ¨¡çµ„è² è²¬ï¼š

- XXX
- XXX

## Aggregate Root
- <Module>

## Events
- <module>.created
- <module>.updated

## Facade API
- executeCommand()

## Notes
- æœ¬æ¨¡çµ„ä¸å¾—ç›´æ¥ä¾è³´å…¶ä»–æ¨¡çµ„
```

### 5.3 ä½¿ç”¨è¦ç¯„ï¼ˆè«‹è²¼åœ¨ README æˆ– Blueprintï¼‰

**æ–°å¢æ¨¡çµ„æµç¨‹ï¼ˆå¼·åˆ¶ï¼‰ï¼š**

1. å»ºç«‹è³‡æ–™å¤¾
2. è£œé½Š `README.md`
3. å®šç¾© `module.metadata.ts`
4. åªé–‹æ”¾ Facade
5. äº‹ä»¶ä¸€å¾‹å¾ Service ç™¼å‡º

---

## çµèª

### æœ¬æ–‡ä»¶å®šç¾©çš„æ˜¯ï¼š

- **ç³»çµ±è¡Œç‚º**
- **æ¨¡çµ„å”ä½œæ–¹å¼**
- **æµç¨‹ç¯€é»è²¬ä»»**
- **äº‹ä»¶èˆ‡ç‹€æ…‹é‚Šç•Œ**

### ä¸æè¿°ï¼š

- å¯¦ä½œå®Œæˆåº¦
- ä»»å‹™é€²åº¦
- å–®ä¸€æŠ€è¡“ç´°ç¯€

### æ­¤æ–‡ä»¶å¯ä½œç‚ºï¼š

- æ¶æ§‹è—åœ–ï¼ˆBlueprintï¼‰
- ç³»çµ±é©—æ”¶åŸºæº–
- æ–°æ¨¡çµ„è¨­è¨ˆä¾æ“š
- æ–‡ä»¶èˆ‡ç¨‹å¼ç¢¼å°é½Šçš„ä¸Šä½è¦ç¯„

---

## æœ€é‡è¦çš„æé†’

> **å¦‚æœä½ ä¸çŸ¥é“æŸæ®µç¨‹å¼è©²æ”¾å“ªè£¡ï¼Œé‚£ä»£è¡¨é€™æ®µè¨­è¨ˆæœ¬èº«æœ‰å•é¡Œã€‚**

---
