# Blueprint V2.0 å°ˆæ¡ˆè¦åŠƒç¸½çµ

> **æ—¥æœŸ**: 2025-01-09  
> **ç‹€æ…‹**: è¦åŠƒå®Œæˆ âœ…  
> **ä¸‹ä¸€æ­¥**: é–‹å§‹å¯¦ä½œ

---

## ğŸ¯ ä»»å‹™å®Œæˆæ‘˜è¦

æ ¹æ“š `setc.md` (Expandable Container Layer Specification)ï¼Œå·²å®Œæˆ GigHub è—åœ–ç³»çµ± V2.0 çš„å®Œæ•´è¦åŠƒï¼ŒåŒ…å«ï¼š

### âœ… å·²å®Œæˆå·¥ä½œ

1. **æŠ€è¡“èª¿æŸ¥èˆ‡ç¢ºèª**
   - ä½¿ç”¨ Context7 æŸ¥è©¢ Angular 20ã€@angular/fireã€TypeScript æœ€ä½³å¯¦è¸
   - ç¢ºèªå°ˆæ¡ˆä½¿ç”¨ @angular/fire 20.0.1 + Firestore (ä¸æ˜¯ Firebase)
   - ç¢ºèª Angular 20.3.0 + ng-alain 20.1.0 + ng-zorro-antd 20.3.1

2. **å®Œæ•´è¦ç¯„æ–‡æª”**
   - `docs/architecture/blueprint-v2-specification.md` (21KB)
   - åŒ…å«ï¼šæ¶æ§‹è¨­è¨ˆã€æ¨¡çµ„è¦ç¯„ã€äº‹ä»¶ç³»çµ±ã€è³‡æ–™æ¨¡å‹ã€API åƒè€ƒã€é–‹ç™¼æŒ‡å—

3. **ç³»çµ±çµæ§‹æ¨¹**
   - `docs/architecture/blueprint-v2-structure-tree.md` (14KB)
   - åŒ…å«ï¼šå®Œæ•´ç›®éŒ„çµæ§‹ã€ä¾è³´é—œä¿‚åœ–ã€æª”æ¡ˆèªªæ˜ã€å¿«é€Ÿç´¢å¼•

4. **å¯¦ä½œè¨ˆç•«**
   - `docs/architecture/blueprint-v2-implementation-plan.md` (12KB)
   - åŒ…å«ï¼š8é€±è©³ç´°æ™‚ç¨‹ã€è³‡æºåˆ†é…ã€é©—æ”¶æ¨™æº–ã€é¢¨éšªç®¡ç†

---

## ğŸ“ ç³»çµ±æ¶æ§‹æ ¸å¿ƒ

### æ ¸å¿ƒå…ƒä»¶

```
Blueprint Container
â”œâ”€â”€ Module Registry      # æ¨¡çµ„è¨»å†Šèˆ‡æŸ¥æ‰¾
â”œâ”€â”€ Lifecycle Manager    # çµ±ä¸€ç”Ÿå‘½é€±æœŸ
â”œâ”€â”€ Event Bus           # æ¨¡çµ„é–“é€šè¨Š
â”œâ”€â”€ Shared Context      # å…±äº«ä¸Šä¸‹æ–‡
â”œâ”€â”€ Resource Provider   # ä¾è³´æ³¨å…¥
â””â”€â”€ Config Manager      # é…ç½®ç®¡ç†
```

### è¨­è¨ˆåŸå‰‡

| åŸå‰‡ | å¯¦ä½œæ–¹å¼ | æ•ˆç›Š |
|------|---------|------|
| **é›¶è€¦åˆ** | Event Bus é€šè¨Š | æ¨¡çµ„å¯ç¨ç«‹é–‹ç™¼ |
| **éš”é›¢æ€§** | æ²™ç®± + éŒ¯èª¤éš”é›¢ | å–®ä¸€æ¨¡çµ„éŒ¯èª¤ä¸å½±éŸ¿ç³»çµ± |
| **å¯æ“´å±•** | å‹•æ…‹è¼‰å…¥æ©Ÿåˆ¶ | ç„¡é™æ–°å¢æ¨¡çµ„ |
| **å¤šç§Ÿæˆ¶** | Firestore RLS | çµ„ç¹”/åœ˜éšŠ/ç”¨æˆ¶éš”é›¢ |
| **å¯©è¨ˆ** | Event Sourcing | å®Œæ•´æ“ä½œæ­·å² |

---

## ğŸ”‘ é—œéµæŠ€è¡“æ±ºç­–

### 1. ä¸å‘å¾Œå…¼å®¹ (Breaking Changes)
- âŒ ç§»é™¤ï¼šèˆŠçš„ Blueprint è³‡æ–™çµæ§‹
- âŒ ç§»é™¤ï¼šç›´æ¥çš„æ¨¡çµ„ç›¸ä¾
- âŒ ç§»é™¤ï¼šåŒæ­¥è¼‰å…¥æ–¹å¼
- âœ… æ–°å¢ï¼šäº‹ä»¶é©…å‹•æ¶æ§‹
- âœ… æ–°å¢ï¼šå‹•æ…‹æ¨¡çµ„è¼‰å…¥
- âœ… æ–°å¢ï¼šçµ±ä¸€ç”Ÿå‘½é€±æœŸç®¡ç†

#

### 3. Angular 20 ç¾ä»£åŒ–ç‰¹æ€§
- âœ… Signals ç‹€æ…‹ç®¡ç†
- âœ… Standalone Components
- âœ… æ–°æ§åˆ¶æµèªæ³• (@if, @for, @switch)
- âœ… `inject()` å‡½å¼
- âœ… `input()`, `output()`, `model()` å‡½å¼

---

## ğŸ“Š å°ˆæ¡ˆè¦æ¨¡ä¼°ç®—

### æª”æ¡ˆçµ±è¨ˆ

| é¡åˆ¥ | æ•¸é‡ | èªªæ˜ |
|------|------|------|
| æ ¸å¿ƒç³»çµ± | ~40 | Container, Events, Context, Modules |
| UI å…ƒä»¶ | ~25 | Designer, Manager, Shared |
| æœå‹™å±¤ | ~15 | Repository, Service, Cache |
| æ¨¡çµ„å¯¦ä½œ | ~20 | Tasks, Logs, Quality, Template |
| æ¸¬è©¦æª”æ¡ˆ | ~30 | Unit, Integration, E2E |
| æ–‡æª” | 5 | Spec, Structure, Plan, Guide, API |
| **ç¸½è¨ˆ** | **~135** | æ–°å¢/é‡æ§‹æª”æ¡ˆ |

### ç¨‹å¼ç¢¼è¡Œæ•¸

| å…ƒä»¶ | è¡Œæ•¸ |
|------|------|
| Blueprint Container | 500 |
| Event Bus | 300 |
| Lifecycle Manager | 400 |
| Module Registry | 250 |
| Resource Provider | 200 |
| Shared Context | 300 |
| Blueprint Designer UI | 800 |
| Module Manager UI | 600 |
| æ¨¡çµ„å¯¦ä½œ (x4) | 1600 |
| æ¸¬è©¦ç¨‹å¼ç¢¼ | 2000 |
| **ç¸½è¨ˆ** | **~6950** |

### æ™‚ç¨‹ä¼°ç®—

| Phase | æ™‚é–“ | å…§å®¹ |
|-------|------|------|
| Phase 1 | Week 1-2 | æ ¸å¿ƒæ¶æ§‹ |
| Phase 2 | Week 3 | Firestore æ•´åˆ |
| Phase 3 | Week 4-5 | UI å…ƒä»¶ |
| Phase 4 | Week 6-7 | æ¨¡çµ„é·ç§» |
| Phase 5 | Week 8 | æ¸¬è©¦èˆ‡å„ªåŒ– |
| **ç¸½è¨ˆ** | **8 é€±** | 2-3 äººåœ˜éšŠ |

---

## ğŸš€ ç«‹å³è¡Œå‹•é …ç›®

### Week 1 (æœ¬é€±é–‹å§‹)

**Day 1-2: ä»‹é¢å®šç¾©** â­ æœ€é«˜å„ªå…ˆç´š
```bash
src/app/core/blueprint/
â”œâ”€â”€ modules/module.interface.ts           # æ¨¡çµ„ä»‹é¢
â”œâ”€â”€ events/event-bus.interface.ts         # äº‹ä»¶ä»‹é¢
â””â”€â”€ context/execution-context.interface.ts # ä¸Šä¸‹æ–‡ä»‹é¢
```

**Day 3-4: äº‹ä»¶ç¸½ç·š**
```bash
src/app/core/blueprint/events/
â”œâ”€â”€ event-bus.ts                          # å¯¦ä½œ
â”œâ”€â”€ event-bus.spec.ts                     # æ¸¬è©¦
â””â”€â”€ event-types.ts                        # æ¨™æº–äº‹ä»¶
```

**Day 5-6: è³‡æºæä¾›è€…**
```bash
src/app/core/blueprint/container/
â”œâ”€â”€ resource-provider.ts                  # å¯¦ä½œ
â””â”€â”€ resource-provider.spec.ts             # æ¸¬è©¦
```

**Day 7: å…±äº«ä¸Šä¸‹æ–‡**
```bash
src/app/core/blueprint/context/
â”œâ”€â”€ shared-context.ts                     # å¯¦ä½œ
â””â”€â”€ shared-context.spec.ts                # æ¸¬è©¦
```

### Week 2 (ä¸‹é€±)

**Day 1-2: æ¨¡çµ„è¨»å†Šè¡¨**
- `module-registry.ts`
- ä¾è³´è§£ææ¼”ç®—æ³•
- ç‰ˆæœ¬ç®¡ç†

**Day 3-5: ç”Ÿå‘½é€±æœŸç®¡ç†å™¨**
- `lifecycle-manager.ts`
- è¼‰å…¥/å•Ÿå‹•/åœæ­¢/å¸è¼‰
- éŒ¯èª¤è™•ç†èˆ‡å›æ»¾

**Day 6-7: è—åœ–å®¹å™¨**
- `blueprint-container.ts`
- æ•´åˆæ‰€æœ‰å­ç³»çµ±
- å®Œæ•´æ¸¬è©¦

---

## ğŸ“š æ–‡æª”ç´¢å¼•

### æ ¸å¿ƒæ–‡æª”

1. **å®Œæ•´è¦ç¯„** (`blueprint-v2-specification.md`)
   - ğŸ”— è·¯å¾‘: `docs/architecture/blueprint-v2-specification.md`
   - ğŸ“– å…§å®¹: æ¶æ§‹è¨­è¨ˆã€æ¨¡çµ„è¦ç¯„ã€API åƒè€ƒã€é–‹ç™¼æŒ‡å—
   - ğŸ“„ å¤§å°: 21KB
   - â­ å„ªå…ˆç´š: P0 (å¿…è®€)

2. **ç³»çµ±çµæ§‹æ¨¹** (`blueprint-v2-structure-tree.md`)
   - ğŸ”— è·¯å¾‘: `docs/architecture/blueprint-v2-structure-tree.md`
   - ğŸ“– å…§å®¹: å®Œæ•´ç›®éŒ„ã€ä¾è³´é—œä¿‚ã€æª”æ¡ˆèªªæ˜
   - ğŸ“„ å¤§å°: 14KB
   - â­ å„ªå…ˆç´š: P0 (å¿…è®€)

3. **å¯¦ä½œè¨ˆç•«** (`blueprint-v2-implementation-plan.md`)
   - ğŸ”— è·¯å¾‘: `docs/architecture/blueprint-v2-implementation-plan.md`
   - ğŸ“– å…§å®¹: 8é€±æ™‚ç¨‹ã€è³‡æºåˆ†é…ã€é©—æ”¶æ¨™æº–
   - ğŸ“„ å¤§å°: 12KB
   - â­ å„ªå…ˆç´š: P0 (å¿…è®€)

### åƒè€ƒæ–‡æª”

4. **setc.md** (åŸå§‹è¦ç¯„)
   - ğŸ”— è·¯å¾‘: å°ˆæ¡ˆæ ¹ç›®éŒ„
   - ğŸ“– å…§å®¹: Expandable Container Layer è¦ç¯„
   - â­ å„ªå…ˆç´š: P1 (åƒè€ƒ)

5. **copilot-instructions.md** (å°ˆæ¡ˆæŒ‡å¼•)
   - ğŸ”— è·¯å¾‘: `.github/copilot-instructions.md`
   - ğŸ“– å…§å®¹: å°ˆæ¡ˆæ¶æ§‹ã€æŠ€è¡“æ£§ã€é–‹ç™¼è¦ç¯„
   - â­ å„ªå…ˆç´š: P1 (åƒè€ƒ)

---

## âœ… é©—æ”¶æ¨™æº–

### åŠŸèƒ½å®Œæ•´æ€§
- âœ… è—åœ–å®¹å™¨å¯å•Ÿå‹•/åœæ­¢
- âœ… æ¨¡çµ„å¯å‹•æ…‹è¼‰å…¥/å¸è¼‰
- âœ… äº‹ä»¶ç¸½ç·šé€šè¨Šæ­£å¸¸
- âœ… æ‰€æœ‰æ ¸å¿ƒæ¨¡çµ„é·ç§»å®Œæˆ
- âœ… UI åŠŸèƒ½å®Œæ•´å¯ç”¨

### å“è³ªæ¨™æº–
- âœ… æ¸¬è©¦è¦†è“‹ç‡ï¼šæ ¸å¿ƒ â‰¥90%, UI â‰¥70%
- âœ… ç„¡ TypeScript éŒ¯èª¤
- âœ… ç„¡ ESLint éŒ¯èª¤
- âœ… ç„¡å®‰å…¨æ€§æ¼æ´
- âœ… WCAG 2.1 AA ç„¡éšœç¤™æ€§

### æ•ˆèƒ½æ¨™æº–
- âœ… æ¨¡çµ„è¼‰å…¥ <100ms
- âœ… äº‹ä»¶è™•ç† <10ms
- âœ… Bundle å¤§å° <2MB (gzip)
- âœ… FCP <1.5s
- âœ… LCP <2.5s

---

## ğŸ‰ ç¸½çµ

### å·²é”æˆç›®æ¨™

1. âœ… **å®Œæ•´è¦ç¯„æ–‡æª”**ï¼šåŸºæ–¼ setc.mdï¼Œé©é… GigHub å°ˆæ¡ˆ
2. âœ… **æ¸…æ™°æ¶æ§‹è¨­è¨ˆ**ï¼šç„¡é™æ“´å±•ã€é›¶è€¦åˆã€å¤šç§Ÿæˆ¶éš”é›¢
3. âœ… **è©³ç´°å¯¦ä½œè¨ˆç•«**ï¼š8é€±æ™‚ç¨‹ã€è³‡æºåˆ†é…ã€é©—æ”¶æ¨™æº–
4. âœ… **æŠ€è¡“æ±ºç­–æ˜ç¢º**ï¼š@angular/fireã€ä¸å‘å¾Œå…¼å®¹ã€ç¾ä»£åŒ–å„ªå…ˆ

### é—œéµç‰¹è‰²

- ğŸ¯ **äº‹ä»¶é©…å‹•æ¶æ§‹**ï¼šæ¨¡çµ„é›¶è€¦åˆï¼Œé€é Event Bus é€šè¨Š
- ğŸ”„ **çµ±ä¸€ç”Ÿå‘½é€±æœŸ**ï¼šinit â†’ start â†’ ready â†’ stop â†’ dispose
- ğŸ”Œ **ç„¡é™æ“´å±•**ï¼šå‹•æ…‹è¼‰å…¥ï¼Œæ”¯æ´ä»»æ„æ•¸é‡æ¨¡çµ„
- ğŸ”’ **å¤šç§Ÿæˆ¶éš”é›¢**ï¼šçµ„ç¹”/åœ˜éšŠ/ç”¨æˆ¶ä¸‰ç´šéš”é›¢
- ğŸ“Š **å®Œæ•´å¯©è¨ˆ**ï¼šEvent Sourcing + Audit Logs
- âš¡ **é«˜æ•ˆèƒ½**ï¼šæ‡¶è¼‰å…¥ã€å¿«å–ã€Bundle å„ªåŒ–

### ä¸‹ä¸€æ­¥

1. **é–‹å§‹å¯¦ä½œ** (Week 1 Day 1)
   - å»ºç«‹æ ¸å¿ƒä»‹é¢å®šç¾©
   - å¯¦ä½œäº‹ä»¶ç¸½ç·š
   - å»ºç«‹è³‡æºæä¾›è€…

2. **æŒçºŒè¿½è¹¤** (æ¯é€±äº”)
   - é€²åº¦å ±å‘Š
   - é¢¨éšªè©•ä¼°
   - é‡Œç¨‹ç¢‘æª¢æŸ¥

3. **å“è³ªä¿è­‰** (æŒçºŒ)
   - ç¨‹å¼ç¢¼å¯©æŸ¥
   - è‡ªå‹•åŒ–æ¸¬è©¦
   - æ•ˆèƒ½ç›£æ§

---

## ğŸ“ è¯çµ¡è³‡è¨Š

**å°ˆæ¡ˆè² è²¬äºº**: [å¾…å¡«]  
**æŠ€è¡“è² è²¬äºº**: [å¾…å¡«]  
**æ–‡æª”ç¶­è­·**: GigHub Development Team  

**å•é¡Œå›å ±**: GitHub Issues  
**æŠ€è¡“è¨è«–**: [å¾…å¡«]  

---

**æ–‡æª”ç‰ˆæœ¬**: 1.0.0  
**å»ºç«‹æ—¥æœŸ**: 2025-01-09  
**æœ€å¾Œæ›´æ–°**: 2025-01-09  
**ç‹€æ…‹**: âœ… è¦åŠƒå®Œæˆï¼Œå¾…é–‹å§‹å¯¦ä½œ
