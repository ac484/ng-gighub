ğŸ¯ æ¶æ§‹ç¸½è¦½

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯ (Angular 20)                      â”‚
â”‚                     Presentation Layer                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¾Œç«¯ (Node.js/NestJS)                     â”‚
â”‚                  Application + Domain Layer                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Infrastructure (Supabase/Firebase)             â”‚
â”‚                    Data Persistence Layer                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ å‰ç«¯æ¶æ§‹ (Angular)
/frontend
â”œâ”€ src/
â”‚  â”œâ”€ app/
â”‚  â”‚  â”œâ”€ core/                          # æ ¸å¿ƒåŸºç¤è¨­æ–½
â”‚  â”‚  â”‚  â”œâ”€ api/                        # API å®¢æˆ¶ç«¯å°è£
â”‚  â”‚  â”‚  â”‚  â”œâ”€ base-api.service.ts      # åŸºç¤ HTTP æœå‹™
â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract-api.service.ts  # åˆç´„ API
â”‚  â”‚  â”‚  â”‚  â”œâ”€ task-api.service.ts      # ä»»å‹™ API
â”‚  â”‚  â”‚  â”‚  â””â”€ websocket.service.ts     # WebSocket é€£æ¥
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ auth/                       # èªè­‰æˆæ¬Š
â”‚  â”‚  â”‚  â”‚  â”œâ”€ auth.service.ts
â”‚  â”‚  â”‚  â”‚  â”œâ”€ auth.guard.ts
â”‚  â”‚  â”‚  â”‚  â””â”€ auth.interceptor.ts
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ state/                      # å‰ç«¯ç‹€æ…‹ç®¡ç†
â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract.store.ts        # åˆç´„ç‹€æ…‹
â”‚  â”‚  â”‚  â”‚  â”œâ”€ task.store.ts            # ä»»å‹™ç‹€æ…‹
â”‚  â”‚  â”‚  â”‚  â””â”€ user.store.ts            # ç”¨æˆ¶ç‹€æ…‹
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ models/                     # å‰ç«¯ DTOs (èˆ‡å¾Œç«¯å°æ‡‰)
â”‚  â”‚  â”‚     â”œâ”€ contract.dto.ts
â”‚  â”‚  â”‚     â”œâ”€ task.dto.ts
â”‚  â”‚  â”‚     â””â”€ response.dto.ts
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ features/                      # åŠŸèƒ½æ¨¡çµ„ (UI å±¤)
â”‚  â”‚  â”‚  â”œâ”€ contract/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ pages/                   # é é¢çµ„ä»¶
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract-list/
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract-detail/
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ contract-create/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ components/              # åŠŸèƒ½çµ„ä»¶
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract-form/
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract-items/
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ contract-status/
â”‚  â”‚  â”‚  â”‚  â””â”€ contract.routes.ts       # è·¯ç”±å®šç¾©
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ task/
â”‚  â”‚  â”‚  â”œâ”€ issue/
â”‚  â”‚  â”‚  â”œâ”€ acceptance/
â”‚  â”‚  â”‚  â”œâ”€ finance/
â”‚  â”‚  â”‚  â””â”€ warranty/
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ shared/                        # å…±ç”¨æ¨¡çµ„
â”‚  â”‚  â”‚  â”œâ”€ components/                 # å…±ç”¨ UI çµ„ä»¶
â”‚  â”‚  â”‚  â”‚  â”œâ”€ data-table/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ file-upload/
â”‚  â”‚  â”‚  â”‚  â””â”€ status-badge/
â”‚  â”‚  â”‚  â”œâ”€ pipes/
â”‚  â”‚  â”‚  â”œâ”€ directives/
â”‚  â”‚  â”‚  â””â”€ utils/
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ layout/                        # ä½ˆå±€çµ„ä»¶
â”‚  â”‚     â”œâ”€ header/
â”‚  â”‚     â”œâ”€ sidebar/
â”‚  â”‚     â””â”€ footer/
â”‚  â”‚
â”‚  â””â”€ environments/
â”‚     â”œâ”€ environment.ts                 # é–‹ç™¼ç’°å¢ƒ
â”‚     â””â”€ environment.prod.ts            # ç”Ÿç”¢ç’°å¢ƒ

ğŸ”§ å¾Œç«¯æ¶æ§‹ (NestJS)
/backend
â”œâ”€ src/
â”‚  â”œâ”€ main.ts                           # æ‡‰ç”¨ç¨‹å¼å…¥å£
â”‚  â”œâ”€ app.module.ts                     # æ ¹æ¨¡çµ„
â”‚  â”‚
â”‚  â”œâ”€ common/                           # å…±ç”¨åŸºç¤è¨­æ–½
â”‚  â”‚  â”œâ”€ decorators/                    # è‡ªå®šç¾©è£é£¾å™¨
â”‚  â”‚  â”œâ”€ filters/                       # ä¾‹å¤–éæ¿¾å™¨
â”‚  â”‚  â”œâ”€ guards/                        # å®ˆè¡›
â”‚  â”‚  â”œâ”€ interceptors/                  # æ””æˆªå™¨
â”‚  â”‚  â”œâ”€ pipes/                         # ç®¡é“é©—è­‰
â”‚  â”‚  â””â”€ dto/                           # å…±ç”¨ DTO
â”‚  â”‚
â”‚  â”œâ”€ config/                           # é…ç½®ç®¡ç†
â”‚  â”‚  â”œâ”€ database.config.ts
â”‚  â”‚  â”œâ”€ auth.config.ts
â”‚  â”‚  â””â”€ app.config.ts
â”‚  â”‚
â”‚  â”œâ”€ modules/                          # æ¥­å‹™æ¨¡çµ„ (Domain Layer)
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ contract/                      # ğŸ—ï¸ åˆç´„æ¨¡çµ„
â”‚  â”‚  â”‚  â”œâ”€ domain/                     # é ˜åŸŸå±¤
â”‚  â”‚  â”‚  â”‚  â”œâ”€ entities/
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract.entity.ts    # èšåˆæ ¹
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ contract-item.entity.ts
â”‚  â”‚  â”‚  â”‚  â”œâ”€ value-objects/
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ amount.vo.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ period.vo.ts
â”‚  â”‚  â”‚  â”‚  â”œâ”€ events/                  # é ˜åŸŸäº‹ä»¶
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract-created.event.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract-approved.event.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ contract-terminated.event.ts
â”‚  â”‚  â”‚  â”‚  â””â”€ repositories/            # Repository ä»‹é¢
â”‚  â”‚  â”‚  â”‚     â””â”€ contract.repository.ts
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ application/                # æ‡‰ç”¨å±¤
â”‚  â”‚  â”‚  â”‚  â”œâ”€ commands/                # å‘½ä»¤è™•ç†
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ create-contract.command.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ create-contract.handler.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ approve-contract.command.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ approve-contract.handler.ts
â”‚  â”‚  â”‚  â”‚  â”œâ”€ queries/                 # æŸ¥è©¢è™•ç†
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ get-contract.query.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ get-contract.handler.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ list-contracts.query.ts
â”‚  â”‚  â”‚  â”‚  â”œâ”€ dto/                     # è³‡æ–™å‚³è¼¸ç‰©ä»¶
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ create-contract.dto.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ update-contract.dto.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ contract-response.dto.ts
â”‚  â”‚  â”‚  â”‚  â””â”€ services/                # æ‡‰ç”¨æœå‹™
â”‚  â”‚  â”‚  â”‚     â””â”€ contract-application.service.ts
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ infrastructure/             # åŸºç¤è¨­æ–½å±¤
â”‚  â”‚  â”‚  â”‚  â”œâ”€ persistence/
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract.repository.impl.ts  # Repository å¯¦ä½œ
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ contract.schema.ts           # DB Schema
â”‚  â”‚  â”‚  â”‚  â””â”€ event-handlers/         # äº‹ä»¶è™•ç†å™¨
â”‚  â”‚  â”‚  â”‚     â”œâ”€ contract-created.handler.ts
â”‚  â”‚  â”‚  â”‚     â””â”€ contract-approved.handler.ts
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ presentation/               # è¡¨ç¾å±¤ (API Controllers)
â”‚  â”‚  â”‚  â”‚  â”œâ”€ contract.controller.ts   # RESTful API
â”‚  â”‚  â”‚  â”‚  â””â”€ contract.gateway.ts      # WebSocket Gateway
â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ contract.module.ts          # æ¨¡çµ„å®šç¾©
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ task/                          # ğŸ“‹ ä»»å‹™æ¨¡çµ„
â”‚  â”‚  â”‚  â”œâ”€ domain/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ entities/
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ task.entity.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ task-assignment.entity.ts
â”‚  â”‚  â”‚  â”‚  â”œâ”€ events/
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ task-created.event.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ task-assigned.event.ts
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ task-completed.event.ts
â”‚  â”‚  â”‚  â”‚  â””â”€ repositories/
â”‚  â”‚  â”‚  â”‚     â””â”€ task.repository.ts
â”‚  â”‚  â”‚  â”œâ”€ application/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ commands/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ queries/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ dto/
â”‚  â”‚  â”‚  â”‚  â””â”€ services/
â”‚  â”‚  â”‚  â”œâ”€ infrastructure/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ persistence/
â”‚  â”‚  â”‚  â”‚  â””â”€ event-handlers/
â”‚  â”‚  â”‚  â”œâ”€ presentation/
â”‚  â”‚  â”‚  â”‚  â””â”€ task.controller.ts
â”‚  â”‚  â”‚  â””â”€ task.module.ts
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ issue/                         # ğŸ› å•é¡Œå–®æ¨¡çµ„
â”‚  â”‚  â”œâ”€ acceptance/                    # âœ… é©—æ”¶æ¨¡çµ„
â”‚  â”‚  â”œâ”€ finance/                       # ğŸ’° è²¡å‹™æ¨¡çµ„
â”‚  â”‚  â”œâ”€ warranty/                      # ğŸ›¡ï¸ ä¿å›ºæ¨¡çµ„
â”‚  â”‚  â”œâ”€ asset/                         # ğŸ“ è³‡ç”¢æª”æ¡ˆæ¨¡çµ„
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ auth/                          # ğŸ” èªè­‰æˆæ¬Šæ¨¡çµ„
â”‚  â”‚  â”‚  â”œâ”€ strategies/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ jwt.strategy.ts
â”‚  â”‚  â”‚  â”‚  â””â”€ local.strategy.ts
â”‚  â”‚  â”‚  â”œâ”€ guards/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ jwt-auth.guard.ts
â”‚  â”‚  â”‚  â”‚  â””â”€ roles.guard.ts
â”‚  â”‚  â”‚  â”œâ”€ auth.service.ts
â”‚  â”‚  â”‚  â”œâ”€ auth.controller.ts
â”‚  â”‚  â”‚  â””â”€ auth.module.ts
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ user/                          # ğŸ‘¤ ç”¨æˆ¶ç®¡ç†æ¨¡çµ„
â”‚  â”‚  â”‚  â”œâ”€ domain/
â”‚  â”‚  â”‚  â”œâ”€ application/
â”‚  â”‚  â”‚  â”œâ”€ infrastructure/
â”‚  â”‚  â”‚  â”œâ”€ presentation/
â”‚  â”‚  â”‚  â””â”€ user.module.ts
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ notification/                  # ğŸ“§ é€šçŸ¥æ¨¡çµ„
â”‚  â”‚     â”œâ”€ channels/
â”‚  â”‚     â”‚  â”œâ”€ email.channel.ts
â”‚  â”‚     â”‚  â”œâ”€ push.channel.ts
â”‚  â”‚     â”‚  â””â”€ sms.channel.ts
â”‚  â”‚     â”œâ”€ notification.service.ts
â”‚  â”‚     â””â”€ notification.module.ts
â”‚  â”‚
â”‚  â”œâ”€ shared/                           # å…±ç”¨æ¨¡çµ„
â”‚  â”‚  â”œâ”€ event-bus/                     # äº‹ä»¶åŒ¯æµæ’
â”‚  â”‚  â”‚  â”œâ”€ event-bus.service.ts
â”‚  â”‚  â”‚  â”œâ”€ domain-event.interface.ts
â”‚  â”‚  â”‚  â””â”€ event-bus.module.ts
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ workflow/                      # å·¥ä½œæµç¨‹å¼•æ“
â”‚  â”‚  â”‚  â”œâ”€ engine/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ workflow.engine.ts
â”‚  â”‚  â”‚  â”‚  â””â”€ execution-context.ts
â”‚  â”‚  â”‚  â”œâ”€ steps/
â”‚  â”‚  â”‚  â””â”€ workflow.module.ts
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ audit/                         # ç¨½æ ¸æ¨¡çµ„
â”‚  â”‚  â”‚  â”œâ”€ audit-log.entity.ts
â”‚  â”‚  â”‚  â”œâ”€ audit.service.ts
â”‚  â”‚  â”‚  â”œâ”€ audit.interceptor.ts
â”‚  â”‚  â”‚  â””â”€ audit.module.ts
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ ai/                            # AI æœå‹™æ¨¡çµ„
â”‚  â”‚     â”œâ”€ providers/
â”‚  â”‚     â”‚  â”œâ”€ vertex/
â”‚  â”‚     â”‚  â””â”€ genai/
â”‚  â”‚     â”œâ”€ ai.service.ts
â”‚  â”‚     â””â”€ ai.module.ts
â”‚  â”‚
â”‚  â””â”€ database/                         # è³‡æ–™åº«ç›¸é—œ
â”‚     â”œâ”€ migrations/                    # é·ç§»æª”æ¡ˆ
â”‚     â”œâ”€ seeds/                         # ç¨®å­è³‡æ–™
â”‚     â””â”€ database.module.ts
â”‚
â”œâ”€ test/                                # æ¸¬è©¦
â”‚  â”œâ”€ unit/
â”‚  â”œâ”€ integration/
â”‚  â””â”€ e2e/
â”‚
â”œâ”€ package.json
â”œâ”€ tsconfig.json
â””â”€ nest-cli.json

ğŸ”„ å‰å¾Œç«¯äº’å‹•æµç¨‹1ï¸âƒ£ å»ºç«‹åˆç´„æµç¨‹

1ï¸âƒ£ å»ºç«‹åˆç´„æµç¨‹

// ==================== å‰ç«¯ ====================
// contract-create.component.ts
export class ContractCreateComponent {
  constructor(
    private contractApi: ContractApiService,
    private contractStore: ContractStore
  ) {}

  async createContract(formData: CreateContractDto): Promise<void> {
    try {
      // å‘¼å«å¾Œç«¯ API
      const contract = await this.contractApi.create(formData);
      
      // æ›´æ–°å‰ç«¯ç‹€æ…‹
      this.contractStore.addContract(contract);
      
      // å°èˆªåˆ°è©³æƒ…é 
      this.router.navigate(['/contracts', contract.id]);
    } catch (error) {
      this.notification.error('å»ºç«‹åˆç´„å¤±æ•—', error.message);
    }
  }
}

// contract-api.service.ts
@Injectable({ providedIn: 'root' })
export class ContractApiService {
  private baseUrl = '/api/contracts';

  constructor(private http: HttpClient) {}

  create(dto: CreateContractDto): Observable<ContractDto> {
    return this.http.post<ContractDto>(this.baseUrl, dto);
  }

  getById(id: string): Observable<ContractDto> {
    return this.http.get<ContractDto>(`${this.baseUrl}/${id}`);
  }

  list(params: QueryParams): Observable<PaginatedResponse<ContractDto>> {
    return this.http.get<PaginatedResponse<ContractDto>>(this.baseUrl, { params });
  }
}

// ==================== å¾Œç«¯ ====================
// contract.controller.ts
@Controller('contracts')
@UseGuards(JwtAuthGuard)
export class ContractController {
  constructor(
    private commandBus: CommandBus,
    private queryBus: QueryBus
  ) {}

  @Post()
  @UsePipes(new ValidationPipe())
  async create(
    @Body() dto: CreateContractDto,
    @CurrentUser() user: UserEntity
  ): Promise<ContractResponseDto> {
    // ç™¼é€å‘½ä»¤åˆ° CQRS
    const command = new CreateContractCommand(dto, user.id);
    const contract = await this.commandBus.execute(command);
    
    return ContractResponseDto.fromEntity(contract);
  }

  @Get(':id')
  async getById(@Param('id') id: string): Promise<ContractResponseDto> {
    const query = new GetContractQuery(id);
    const contract = await this.queryBus.execute(query);
    
    return ContractResponseDto.fromEntity(contract);
  }
}

// create-contract.handler.ts (CQRS Command Handler)
@CommandHandler(CreateContractCommand)
export class CreateContractHandler implements ICommandHandler<CreateContractCommand> {
  constructor(
    private contractRepository: ContractRepository,
    private eventBus: EventBus
  ) {}

  async execute(command: CreateContractCommand): Promise<ContractEntity> {
    // 1. å»ºç«‹èšåˆæ ¹
    const contract = ContractEntity.create({
      number: command.number,
      amount: new Amount(command.amount, command.currency),
      period: new Period(command.startDate, command.endDate),
      createdBy: command.userId
    });

    // 2. æ¥­å‹™é‚è¼¯é©—è­‰
    contract.validate();

    // 3. æŒä¹…åŒ–
    await this.contractRepository.save(contract);

    // 4. ç™¼å¸ƒé ˜åŸŸäº‹ä»¶
    this.eventBus.publish(new ContractCreatedEvent(contract));

    return contract;
  }
}

// contract-created.handler.ts (Event Handler)
@EventsHandler(ContractCreatedEvent)
export class ContractCreatedHandler implements IEventHandler<ContractCreatedEvent> {
  constructor(
    private notificationService: NotificationService,
    private auditService: AuditService,
    private workflowEngine: WorkflowEngine
  ) {}

  async handle(event: ContractCreatedEvent): Promise<void> {
    const { contract } = event;

    // è¨˜éŒ„ç¨½æ ¸æ—¥èªŒ
    await this.auditService.log({
      action: 'CONTRACT_CREATED',
      entityId: contract.id,
      userId: contract.createdBy,
      metadata: { contractNumber: contract.number }
    });

    // ç™¼é€é€šçŸ¥
    await this.notificationService.send({
      type: 'EMAIL',
      to: contract.owner,
      template: 'contract-created',
      data: { contract }
    });

    // å•Ÿå‹•å·¥ä½œæµç¨‹
    await this.workflowEngine.start('contract-approval', {
      contractId: contract.id
    });
  }
}
```

---

## ğŸ“Š è³‡æ–™æµå‘åœ–
```
å‰ç«¯ Angular                        å¾Œç«¯ NestJS                         è³‡æ–™åº«
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚  1. HTTP POST    â”‚              â”‚                  â”‚              â”‚
â”‚ ContractForm â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ Controller   â”‚                  â”‚  Supabase    â”‚
â”‚  Component   â”‚                  â”‚              â”‚                  â”‚  Postgres    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†‘                                 â”‚                                  â†‘
       â”‚                                 â”‚ 2. Execute                       â”‚
       â”‚                                 â†“                                  â”‚
       â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
       â”‚                          â”‚   Command    â”‚                         â”‚
       â”‚                          â”‚   Handler    â”‚                         â”‚
       â”‚                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
       â”‚                                 â”‚                                  â”‚
       â”‚                                 â”‚ 3. Business Logic                â”‚
       â”‚                                 â†“                                  â”‚
       â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
       â”‚                          â”‚   Domain     â”‚                         â”‚
       â”‚                          â”‚   Entity     â”‚                         â”‚
       â”‚                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
       â”‚                                 â”‚                                  â”‚
       â”‚                                 â”‚ 4. Save                          â”‚
       â”‚                                 â†“                                  â”‚
       â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    5. Persist          â”‚
       â”‚                          â”‚  Repository  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
       â”‚                                 â”‚                                  â”‚
       â”‚                                 â”‚ 6. Publish Event                 â”‚
       â”‚                                 â†“                                  â”‚
       â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
       â”‚                          â”‚  Event Bus   â”‚                         â”‚
       â”‚                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
       â”‚                                 â”‚                                  â”‚
       â”‚                                 â”‚ 7. Trigger                       â”‚
       â”‚                                 â†“                                  â”‚
       â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
       â”‚                          â”‚Event Handlersâ”‚                         â”‚
       â”‚                          â”‚- Notificationâ”‚                         â”‚
       â”‚                          â”‚- Audit       â”‚                         â”‚
       â”‚                          â”‚- Workflow    â”‚                         â”‚
       â”‚                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
       â”‚                                 â”‚                                  â”‚
       â”‚  8. Response (DTO)              â”‚                                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚

ğŸ” èªè­‰æˆæ¬Šæµç¨‹

// ==================== å‰ç«¯ ====================
// auth.interceptor.ts
@Injectable()
export class AuthInterceptor implements HttpInterceptor {
  constructor(private authService: AuthService) {}

  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {
    const token = this.authService.getToken();
    
    if (token) {
      req = req.clone({
        setHeaders: {
          Authorization: `Bearer ${token}`
        }
      });
    }
    
    return next.handle(req).pipe(
      catchError((error: HttpErrorResponse) => {
        if (error.status === 401) {
          this.authService.logout();
          this.router.navigate(['/login']);
        }
        return throwError(() => error);
      })
    );
  }
}

// ==================== å¾Œç«¯ ====================
// jwt.strategy.ts
@Injectable()
export class JwtStrategy extends PassportStrategy(Strategy) {
  constructor(private configService: ConfigService) {
    super({
      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
      secretOrKey: configService.get('JWT_SECRET'),
    });
  }

  async validate(payload: JwtPayload): Promise<UserEntity> {
    return {
      id: payload.sub,
      email: payload.email,
      roles: payload.roles
    };
  }
}

// roles.guard.ts
@Injectable()
export class RolesGuard implements CanActivate {
  constructor(private reflector: Reflector) {}

  canActivate(context: ExecutionContext): boolean {
    const requiredRoles = this.reflector.get<string[]>('roles', context.getHandler());
    if (!requiredRoles) return true;

    const request = context.switchToHttp().getRequest();
    const user = request.user;

    return requiredRoles.some(role => user.roles?.includes(role));
  }
}
```

---

## ğŸš€ éƒ¨ç½²æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CDN (Cloudflare)                      â”‚
â”‚                    Static Assets / Images                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å‰ç«¯ (Vercel / Netlify)                     â”‚
â”‚                Angular App (SSR/SSG å¯é¸)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Load Balancer (AWS ALB / GCP LB)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¾Œç«¯ Instance 1  â”‚                     â”‚  å¾Œç«¯ Instance 2  â”‚
â”‚  NestJS + Node   â”‚                     â”‚  NestJS + Node   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                     â†“                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase    â”‚    â”‚    Redis     â”‚    â”‚  File Storageâ”‚
â”‚  (Postgres)  â”‚    â”‚   (Cache)    â”‚    â”‚   (S3/GCS)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ğŸ“ é—œéµå·®ç•°ç¸½çµ
å±¤é¢å‰ç«¯ (Angular)å¾Œç«¯ (NestJS)è·è²¬UI å‘ˆç¾ã€ç”¨æˆ¶äº’å‹•æ¥­å‹™é‚è¼¯ã€è³‡æ–™è™•ç†ç‹€æ…‹ç®¡ç†RxJS Store (å®¢æˆ¶ç«¯ç‹€æ…‹)ç„¡ç‹€æ…‹ (Stateless)è³‡æ–™å­˜å–HTTP API å‘¼å«ç›´æ¥å­˜å–è³‡æ–™åº«é©—è­‰åŸºç¤ UI é©—è­‰å®Œæ•´æ¥­å‹™è¦å‰‡é©—è­‰äº‹ä»¶UI äº‹ä»¶é ˜åŸŸäº‹ä»¶ (DDD)å¿«å–æœ¬åœ°å¿«å–Redis / Memory Cacheæª”æ¡ˆè™•ç†ä¸Šå‚³ä»‹é¢æª”æ¡ˆå„²å­˜èˆ‡ç®¡ç†